<!-- templates/approvals/admin_dashboard.html -->
{% extends 'base.html' %}

{% block content %}
<h2>Admin Dashboard</h2>

<ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending" type="button" role="tab">
            Pending <span class="badge bg-secondary">{{ pending_enquiries.count }}</span>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="approved-tab" data-bs-toggle="tab" data-bs-target="#approved" type="button" role="tab">
            Approved <span class="badge bg-success">{{ approved_enquiries.count }}</span>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="rejected-tab" data-bs-toggle="tab" data-bs-target="#rejected" type="button" role="tab">
            Rejected <span class="badge bg-danger">{{ rejected_enquiries.count }}</span>
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="myTabContent">
    <!-- Pending Enquiries Tab -->
    <div class="tab-pane fade show active" id="pending" role="tabpanel">
        {% if pending_enquiries %}
            <div class="list-group">
                {% for enquiry in pending_enquiries %}
                    <div class="list-group-item">
                        <h6 class="mb-1">{{ enquiry.ad_title }}</h6>
                        <p class="mb-1">From: {{ enquiry.name }} ({{ enquiry.contact_number }})</p>
                        <small>Submitted: {{ enquiry.created_at|date:"M d, Y" }} by {{ enquiry.user.username }}</small>
                        <div class="mt-2">
                            <a href="{% url 'approvals:update_status' enquiry.id %}" class="btn btn-sm btn-outline-primary">Review</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No pending enquiries.</p>
        {% endif %}
    </div>

    <!-- Approved Enquiries Tab -->
    <div class="tab-pane fade" id="approved" role="tabpanel">
        {% if approved_enquiries %}
            <div class="list-group">
                {% for enquiry in approved_enquiries %}
                    <div class="list-group-item">
                        <h6 class="mb-1">{{ enquiry.ad_title }}</h6>
                        <p class="mb-1">From: {{ enquiry.name }} ({{ enquiry.contact_number }})</p>
                        <p class="mb-1">
                            Dates: {{ enquiry.start_date|date:"M d, Y" }} to {{ enquiry.end_date|date:"M d, Y" }}
                        </p>
                        <small>Approved for: {{ enquiry.user.username }}</small>
                        <div class="mt-2">
                            <a href="{% url 'approvals:update_status' enquiry.id %}" class="btn btn-sm btn-outline-secondary">Modify</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No approved enquiries.</p>
        {% endif %}
    </div>

    <!-- Rejected Enquiries Tab -->
    <div class="tab-pane fade" id="rejected" role="tabpanel">
        {% if rejected_enquiries %}
            <div class="list-group">
                {% for enquiry in rejected_enquiries %}
                    <div class="list-group-item">
                        <h6 class="mb-1">{{ enquiry.ad_title }}</h6>
                        <p class="mb-1">From: {{ enquiry.name }} ({{ enquiry.contact_number }})</p>
                        <small>Rejected for: {{ enquiry.user.username }}</small>
                        <div class="mt-2">
                            <a href="{% url 'approvals:update_status' enquiry.id %}" class="btn btn-sm btn-outline-secondary">Review</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No rejected enquiries.</p>
        {% endif %}
    </div>
</div>
{% endblock %}